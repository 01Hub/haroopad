reMarked=function(e){function t(e,i){if(!i)return e;for(var r in e)"Object"==n(i[r])?t(e[r],i[r]):i[r]!==void 0&&(e[r]=i[r])}function n(e){return Object.prototype.toString.call(e).slice(8,-1)}function i(e,t){for(var n="";t-->0;)n+=e;return n}function r(e){for(var e=e.replace(/^\s\s*/,""),t=/\s/,n=e.length;t.test(e.charAt(--n)););return e.slice(0,n+1)}function s(e,t){if(!e)return"";for(var n,i="<"+e,r=0;t.attributes.length>r;r++)n=t.attributes.item(r),i+=" "+n.nodeName+'="'+n.nodeValue+'"';return i+">"}function a(e){return e?"</"+e+">":""}function o(e,t){return e.replace(/^/gm,t)}function c(e){return("#text"==e.nodeName?"txt":e.nodeName).toLowerCase()}function u(e,t){var n,i;return t instanceof Array?(n=t[0],i=t[1]):n=i=t,n=n instanceof Function?n.call(this,e):n,i=i instanceof Function?i.call(this,e):i,n+e+i}function l(e){return e.outerHTML||function(e){var t,n=document.createElement("div");return n.appendChild(e.cloneNode(!0)),t=n.innerHTML,n=null,t}(e)}var h=[],d={link_list:!1,h1_setext:!0,h2_setext:!0,h_atx_suf:!1,gfm_code:!1,li_bullet:"*-+"[0],hr_char:"-_*"[0],indnt_str:["    ","	","  "][0],bold_char:"*_"[0],emph_char:"*_"[1],gfm_del:!0,gfm_tbls:!0,tbl_edges:!1,hash_lnks:!1,br_only:!1,col_pre:"col ",unsup_tags:{ignore:"script style noscript",inline:"span sup sub i u b center big",block2:"div form fieldset dl header footer address article aside figure hgroup section",block1c:"dt dd caption legend figcaption output",block2c:"canvas audio video iframe"},tag_remap:{i:"em",b:"strong"}};t(d,e),this.render=function(e){if(h=[],"string"==typeof e){var t=e;e=document.createElement("div"),e.innerHTML=t}var n=new p.tag(e,null,0),r=n.rend().replace(/^[\t ]+\n/gm,"\n");if(d.link_list&&h.length>0){r+="\n\n";for(var s=0,a=0;h.length>a;a++)if(h[a].e.title){var o=h[a].e.href.length;o&&o>s&&(s=o)}for(var u=0;h.length>u;u++){var l=h[u].e.title?i(" ",s+2-h[u].e.href.length)+'"'+h[u].e.title+'"':"";r+="  ["+(+u+1)+"]: "+("a"==c(h[u].e)?h[u].e.href:h[u].e.src)+l+"\n"}}return r.replace(/^[\t ]+\n/gm,"\n")};var p={};p.tag=klass({wrap:"",lnPfx:"",lnInd:0,init:function(e,t,n){this.e=e,this.p=t,this.i=n,this.c=[],this.tag=c(e),this.initK()},initK:function(){var e;if(this.e.hasChildNodes()){var t,n,i=d.unsup_tags.inline;if("table"==c(this.e)&&this.e.hasChildNodes()&&!this.e.tHead){var r=document.createElement("thead"),s=this.e.tBodies[0],a=s.rows[0],o=a.cells[0];if("th"==c(o))r.appendChild(a);else for(var u,e=0,l=a.cells.length,f=r.insertRow();l>e++;)u=document.createElement("th"),u.textContent=d.col_pre+e,f.appendChild(u);this.e.insertBefore(r,s)}for(e in this.e.childNodes)if(/\d+/.test(e)&&(t=this.e.childNodes[e],n=c(t),n in d.tag_remap&&(n=d.tag_remap[n]),!d.unsup_tags.ignore.test(n))){if("txt"==n&&/^\s+$/.test(t.textContent)){if(0==e||e==this.e.childNodes.length-1)continue;var g=this.e.childNodes[e-1],m=this.e.childNodes[e+1];if(g&&!c(g).match(i)||m&&!c(m).match(i))continue}var x=null;if(!p[n]){var b=d.unsup_tags;b.inline.test(n)?n="tinl":b.block2.test(n)?n="tblk":b.block1c.test(n)?n="ctblk":b.block2c.test(n)?(n="ctblk",x=["\n\n",""]):n="rawhtml"}var v=new p[n](t,this,this.c.length);x&&(v.wrap=x),(v instanceof p.a&&t.href||v instanceof p.img)&&(v.lnkid=h.length,h.push(v)),this.c.push(v)}}},rend:function(){return this.rendK().replace(/\n{3,}/gm,"\n\n")},rendK:function(){for(var e,t="",n=0;this.c.length>n;n++)e=this.c[n],t+=(e.bef||"")+e.rend()+(e.aft||"");return t.replace(/^\n+|\n+$/,"")}}),p.blk=p.tag.extend({wrap:["\n\n",""],wrapK:null,tagr:!1,lnInd:null,init:function(e,t,n){this.supr(e,t,n),null===this.lnInd&&(this.lnInd=this.p&&this.tagr&&this.c[0]instanceof p.blk?4:0),null===this.wrapK&&(this.wrapK=this.tagr&&this.c[0]instanceof p.blk?"\n":"")},rend:function(){return u.call(this,(this.tagr?s(this.tag,this.e):"")+u.call(this,o(o(this.rendK(),this.lnPfx),i(" ",this.lnInd)),this.wrapK)+(this.tagr?a(this.tag):""),this.wrap)},rendK:function(){var e=this.supr();if(this.p instanceof p.li){var t=null,n=e.match(/^[\t ]+/gm);if(!n)return e;for(var i=0;n.length>i;i++)(null===t||n[i][0].length<t.length)&&(t=n[i][0]);return e.replace(RegExp("^"+t),"")}return e}}),p.tblk=p.blk.extend({tagr:!0}),p.cblk=p.blk.extend({wrap:["\n",""]}),p.ctblk=p.cblk.extend({tagr:!0}),p.inl=p.tag.extend({rend:function(){return u.call(this,this.rendK(),this.wrap)}}),p.tinl=p.inl.extend({tagr:!0,rend:function(){return s(this.tag,this.e)+u.call(this,this.rendK(),this.wrap)+a(this.tag)}}),p.p=p.blk.extend({rendK:function(){return this.supr().replace(/^\s+/gm,"")}}),p.list=p.blk.extend({expn:!1,wrap:[function(){return this.p instanceof p.li?"\n":"\n\n"},""]}),p.ul=p.list.extend({}),p.ol=p.list.extend({}),p.li=p.cblk.extend({wrap:["\n",function(e){return this.p.expn||e.match(/\n{2}/gm)?"\n":""}],wrapK:[function(){return"ul"==this.p.tag?d.li_bullet+" ":this.i+1+".  "},""],rendK:function(){return this.supr().replace(/\n([^\n])/gm,"\n"+d.indnt_str+"$1")}}),p.hr=p.blk.extend({wrap:["\n\n",i(d.hr_char,3)]}),p.h=p.blk.extend({}),p.h_setext=p.h.extend({}),d.h1_setext&&(p.h1=p.h_setext.extend({wrapK:["",function(e){return"\n"+i("=",e.length)}]})),d.h2_setext&&(p.h2=p.h_setext.extend({wrapK:["",function(e){return"\n"+i("-",e.length)}]})),p.h_atx=p.h.extend({wrapK:[function(){return i("#",this.tag[1])+" "},function(){return d.h_atx_suf?" "+i("#",this.tag[1]):""}]}),!d.h1_setext&&(p.h1=p.h_atx.extend({})),!d.h2_setext&&(p.h2=p.h_atx.extend({})),p.h3=p.h_atx.extend({}),p.h4=p.h_atx.extend({}),p.h5=p.h_atx.extend({}),p.h6=p.h_atx.extend({}),p.a=p.inl.extend({lnkid:null,rend:function(){var e=this.rendK(),t=this.e.getAttribute("href"),n=this.e.title?' "'+this.e.title+'"':"";return!t||t==e||"#"==t[0]&&!d.hash_lnks?e:d.link_list?"["+e+"] ["+(this.lnkid+1)+"]":"["+e+"]("+t+n+")"}}),p.img=p.inl.extend({lnkid:null,rend:function(){var e=this.e.alt,t=this.e.getAttribute("src");if(d.link_list)return"!["+e+"] ["+(this.lnkid+1)+"]";var n=this.e.title?' "'+this.e.title+'"':"";return"!["+e+"]("+t+n+")"}}),p.em=p.inl.extend({wrap:d.emph_char}),p.del=d.gfm_del?p.inl.extend({wrap:"~~"}):p.tinl.extend(),p.br=p.inl.extend({wrap:["",function(){var e=d.br_only?"<br>":"  ";return this.p instanceof p.h?"<br>":e+"\n"}]}),p.strong=p.inl.extend({wrap:i(d.bold_char,2)}),p.blockquote=p.blk.extend({lnPfx:"> ",rend:function(){return this.supr().replace(/>[ \t]$/gm,">")}}),p.pre=p.blk.extend({tagr:!0,wrapK:"\n",lnInd:0}),p.code=p.blk.extend({tagr:!1,wrap:"",wrapK:function(e){return-1!==e.indexOf("`")?"``":"`"},lnInd:0,init:function(e,t,n){if(this.supr(e,t,n),this.p instanceof p.pre)if(this.p.tagr=!1,d.gfm_code){var i=this.e.getAttribute("class");i=(i||"").split(" ")[0],0===i.indexOf("lang-")&&(i=i.substr(5)),this.wrapK=["```"+i+"\n","\n```"]}else this.wrapK="",this.p.lnInd=4}}),p.table=d.gfm_tbls?p.blk.extend({cols:[],init:function(e,t,n){this.supr(e,t,n),this.cols=[]},rend:function(){for(var e=0;this.c.length>e;e++)for(var t=0;this.c[e].c.length>t;t++)for(var n=0;this.c[e].c[t].c.length>n;n++)this.c[e].c[t].c[n].prep();return this.supr()}}):p.tblk.extend(),p.thead=d.gfm_tbls?p.cblk.extend({wrap:["\n",function(){for(var e="",t=0;this.p.cols.length>t;t++){var n=this.p.cols[t],s="c"==n.a[0]?":":" ",a="r"==n.a[0]||"c"==n.a[0]?":":" ";e+=(0==t&&d.tbl_edges?"|":"")+s+i("-",n.w)+a+(this.p.cols.length-1>t||d.tbl_edges?"|":"")}return"\n"+r(e)}]}):p.ctblk.extend(),p.tbody=d.gfm_tbls?p.cblk.extend():p.ctblk.extend(),p.tfoot=d.gfm_tbls?p.cblk.extend():p.ctblk.extend(),p.tr=d.gfm_tbls?p.cblk.extend({wrapK:[d.tbl_edges?"| ":"",d.tbl_edges?" |":""]}):p.ctblk.extend(),p.th=d.gfm_tbls?p.inl.extend({guts:null,wrap:[function(){var e,t=this.p.p.p.cols[this.i],n=0==this.i?"":" ",r=t.w-this.guts.length;switch(t.a[0]){case"r":e=i(" ",r);break;case"c":e=i(" ",Math.floor(r/2));break;default:e=""}return n+e},function(){var e,t=this.p.p.p.cols[this.i],n=this.i==this.p.c.length-1?"":" |",r=t.w-this.guts.length;switch(t.a[0]){case"r":e="";break;case"c":e=i(" ",Math.ceil(r/2));break;default:e=i(" ",r)}return e+n}],prep:function(){this.guts=this.rendK(),this.rendK=function(){return this.guts};var e=this.p.p.p.cols;e[this.i]||(e[this.i]={w:null,a:""});var t=e[this.i];t.w=Math.max(t.w||0,this.guts.length),this.e.align&&(t.a=this.e.align)}}):p.ctblk.extend(),p.td=p.th.extend(),p.txt=p.inl.extend({initK:function(){this.c=this.e.textContent.split(/^/gm)},rendK:function(){var e=this.c.join("").replace(/\r/gm,"");return this.p instanceof p.code||this.p instanceof p.pre||(e=e.replace(/^\s*#/gm,"\\#").replace(/\*/gm,"\\*")),0==this.i&&(e=e.replace(/^\n+/,"")),this.i==this.p.c.length-1&&(e=e.replace(/\n+$/,"")),e}}),p.rawhtml=p.blk.extend({initK:function(){this.guts=l(this.e)},rendK:function(){return this.guts}});for(var f in d.unsup_tags)d.unsup_tags[f]=RegExp("^(?:"+("inline"==f?"a|em|strong|img|code|del|":"")+d.unsup_tags[f].replace(/\s/g,"|")+")$")},!function(e,t){"function"==typeof define?define(t):"undefined"!=typeof module?module.exports=t():this[e]=t()}("klass",function(){function e(e){return r.call(t(e)?e:function(){},e,1)}function t(e){return typeof e===o}function n(e,t,n){return function(){var i=this.supr;this.supr=n[u][e];var r=t.apply(this,arguments);return this.supr=i,r}}function i(e,i,r){for(var s in i)i.hasOwnProperty(s)&&(e[s]=t(i[s])&&t(r[u][s])&&c.test(i[s])?n(s,i[s],r):i[s])}function r(e,n){function r(){}function s(){this.init?this.init.apply(this,arguments):(n||c&&a.apply(this,arguments),l.apply(this,arguments))}r[u]=this[u];var a=this,o=new r,c=t(e),l=c?e:this,h=c?{}:e;return s.methods=function(e){return i(o,e,a),s[u]=o,this},s.methods.call(s,h).prototype.constructor=s,s.extend=arguments.callee,s[u].implement=s.statics=function(e,t){return e="string"==typeof e?function(){var n={};return n[e]=t,n}():e,i(this,e,a),this},s}var s=this,a=s.klass,o="function",c=/xyz/.test(function(){})?/\bsupr\b/:/.*/,u="prototype";return e.noConflict=function(){return s.klass=a,this},s.klass=e,e});