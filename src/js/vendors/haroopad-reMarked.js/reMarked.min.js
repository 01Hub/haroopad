reMarked=function(opts){function extend(e,t){if(!t)return e;for(var r in e)"Object"==typeOf(t[r])?extend(e[r],t[r]):t[r]!==void 0&&(e[r]=t[r])}function typeOf(e){return Object.prototype.toString.call(e).slice(8,-1)}function rep(e,t){for(var r="";t-->0;)r+=e;return r}function trim12(e){for(var e=e.replace(/^\s\s*/,""),t=/\s/,r=e.length;t.test(e.charAt(--r)););return e.slice(0,r+1)}function lpad(e,t,r){return rep(t,r-e.length)+e}function rpad(e,t,r){return e+rep(t,r-e.length)}function otag(e,t){if(!e)return"";for(var r,n="<"+e,i=0;t.attributes.length>i;i++)r=t.attributes.item(i),n+=" "+r.nodeName+'="'+r.nodeValue+'"';return n+">"}function ctag(e){return e?"</"+e+">":""}function pfxLines(e,t){return e.replace(/^/gm,t)}function nodeName(e){return("#text"==e.nodeName?"txt":e.nodeName).toLowerCase()}function wrap(e,t){var r,n;return t instanceof Array?(r=t[0],n=t[1]):r=n=t,r=r instanceof Function?r.call(this,e):r,n=n instanceof Function?n.call(this,e):n,r+e+n}function outerHTML(e){return e.outerHTML||function(e){var t,r=document.createElement("div");return r.appendChild(e.cloneNode(!0)),t=r.innerHTML,r=null,t}(e)}var links=[],cfg={link_list:!1,h1_setext:!0,h2_setext:!0,h_atx_suf:!1,gfm_code:["```","~~~"][0],trim_code:!0,li_bullet:"*-+"[0],hr_char:"-_*"[0],indnt_str:["    ","	","  "][0],bold_char:"*_"[0],emph_char:"*_"[1],gfm_del:!0,gfm_tbls:!0,tbl_edges:!1,hash_lnks:!1,br_only:!1,col_pre:"col ",nbsp_spc:!1,span_tags:!0,div_tags:!0,unsup_tags:{ignore:"script style noscript",inline:"span sup sub i u b center big",block2:"div form fieldset dl header footer address article aside figure hgroup section",block1c:"dt dd caption legend figcaption output",block2c:"canvas audio video iframe"},tag_remap:{i:"em",b:"strong"}},isIE=eval("/*@cc_on!@*/!1"),docMode=document.documentMode,ieLt9=isIE&&(!docMode||9>docMode),textContProp="textContent"in Element.prototype||!ieLt9?"textContent":"innerText";extend(cfg,opts),this.render=function(e){links=[];var t=document.createElement("div");t.innerHTML="string"==typeof e?e:outerHTML(e);var r=new lib.tag(t,null,0),n=r.rend().replace(/^[\t ]+[\n\r]+/gm,"\n").replace(/^[\n\r]+|[\n\r]+$/g,"");if(cfg.link_list&&links.length>0){n+="\n\n";for(var i=0,o=0;links.length>o;o++)if(links[o].e.title){var a=links[o].e.href.length;a&&a>i&&(i=a)}for(var s=0;links.length>s;s++){var l=links[s].e.title?rep(" ",i+2-links[s].e.href.length)+'"'+links[s].e.title+'"':"";n+="  ["+(+s+1)+"]: "+("a"==nodeName(links[s].e)?links[s].e.href:links[s].e.src)+l+"\n"}}return n.replace(/^[\t ]+\n/gm,"\n")};var lib={};lib.tag=klass({wrap:"",lnPfx:"",lnInd:0,init:function(e,t,r){this.e=e,this.p=t,this.i=r,this.c=[],this.tag=nodeName(e),this.initK()},initK:function(){var e;if(this.e.hasChildNodes()){var t,r,n=cfg.unsup_tags.inline;if("table"==nodeName(this.e)&&this.e.hasChildNodes()&&!this.e.tHead){var i=document.createElement("thead"),o=this.e.tBodies[0],a=o.rows[0],s=a.cells[0];if("th"==nodeName(s))i.appendChild(a);else for(var l,e=0,c=a.cells.length,u=i.insertRow();c>e++;)l=document.createElement("th"),l[textContProp]=cfg.col_pre+e,u.appendChild(l);this.e.insertBefore(i,o)}for(e in this.e.childNodes)if(/\d+/.test(e)&&(t=this.e.childNodes[e],r=nodeName(t),r in cfg.tag_remap&&(r=cfg.tag_remap[r]),!cfg.unsup_tags.ignore.test(r))){if("txt"==r&&!nodeName(this.e).match(n)&&/^\s+$/.test(t[textContProp])){if(0==e||e==this.e.childNodes.length-1)continue;var f=this.e.childNodes[e-1],d=this.e.childNodes[e+1];if(f&&!nodeName(f).match(n)||d&&!nodeName(d).match(n))continue}var h=null;if(!lib[r]){var p=cfg.unsup_tags;p.inline.test(r)?r="span"!=r||cfg.span_tags?"tinl":"inl":p.block2.test(r)?r="div"!=r||cfg.div_tags?"tblk":"blk":p.block1c.test(r)?r="ctblk":p.block2c.test(r)?(r="ctblk",h=["\n\n",""]):r="rawhtml"}var m=new lib[r](t,this,this.c.length);h&&(m.wrap=h),(m instanceof lib.a&&t.href||m instanceof lib.img)&&(m.lnkid=links.length,links.push(m)),this.c.push(m)}}},rend:function(){return this.rendK().replace(/\n{3,}/gm,"\n\n")},rendK:function(){for(var e,t="",r=0;this.c.length>r;r++)e=this.c[r],t+=(e.bef||"")+e.rend()+(e.aft||"");return t.replace(/^\n+|\n+$/,"")}}),lib.blk=lib.tag.extend({wrap:["\n\n",""],wrapK:null,tagr:!1,lnInd:null,init:function(e,t,r){this.supr(e,t,r),null===this.lnInd&&(this.lnInd=this.p&&this.tagr&&this.c[0]instanceof lib.blk?4:0),null===this.wrapK&&(this.wrapK=this.tagr&&this.c[0]instanceof lib.blk?"\n":"")},rend:function(){return wrap.call(this,(this.tagr?otag(this.tag,this.e):"")+wrap.call(this,pfxLines(pfxLines(this.rendK(),this.lnPfx),rep(" ",this.lnInd)),this.wrapK)+(this.tagr?ctag(this.tag):""),this.wrap)},rendK:function(){var e=this.supr();if(this.p instanceof lib.li){var t=null,r=e.match(/^[\t ]+/gm);if(!r)return e;for(var n=0;r.length>n;n++)(null===t||r[n][0].length<t.length)&&(t=r[n][0]);return e.replace(RegExp("^"+t),"")}return e}}),lib.tblk=lib.blk.extend({tagr:!0}),lib.cblk=lib.blk.extend({wrap:["\n",""]}),lib.ctblk=lib.cblk.extend({tagr:!0}),lib.inl=lib.tag.extend({rend:function(){var e=this.rendK(),t=e.match(/^((?: |\t|&nbsp;)*)(.*?)((?: |\t|&nbsp;)*)$/)||[e,"",e,""];return t[1]+wrap.call(this,t[2],this.wrap)+t[3]}}),lib.tinl=lib.inl.extend({tagr:!0,rend:function(){return otag(this.tag,this.e)+wrap.call(this,this.rendK(),this.wrap)+ctag(this.tag)}}),lib.p=lib.blk.extend({rendK:function(){return this.supr().replace(/^\s+/gm,"")}}),lib.list=lib.blk.extend({wrap:[function(){return this.p instanceof lib.li?"\n":"\n\n"},""]}),lib.ul=lib.list.extend({}),lib.ol=lib.list.extend({}),lib.li=lib.cblk.extend({wrap:["\n",function(e){return this.c[0]&&this.c[0]instanceof lib.p||e.match(/\n{2}/gm)?"\n":""}],wrapK:[function(){return"ul"==this.p.tag?cfg.li_bullet+" ":this.i+1+".  "},""],rendK:function(){return this.supr().replace(/\n([^\n])/gm,"\n"+cfg.indnt_str+"$1")}}),lib.hr=lib.blk.extend({wrap:["\n\n",rep(cfg.hr_char,3)]}),lib.h=lib.blk.extend({}),lib.h_setext=lib.h.extend({}),cfg.h1_setext&&(lib.h1=lib.h_setext.extend({wrapK:["",function(e){return"\n"+rep("=",e.length)}]})),cfg.h2_setext&&(lib.h2=lib.h_setext.extend({wrapK:["",function(e){return"\n"+rep("-",e.length)}]})),lib.h_atx=lib.h.extend({wrapK:[function(){return rep("#",this.tag[1])+" "},function(){return cfg.h_atx_suf?" "+rep("#",this.tag[1]):""}]}),!cfg.h1_setext&&(lib.h1=lib.h_atx.extend({})),!cfg.h2_setext&&(lib.h2=lib.h_atx.extend({})),lib.h3=lib.h_atx.extend({}),lib.h4=lib.h_atx.extend({}),lib.h5=lib.h_atx.extend({}),lib.h6=lib.h_atx.extend({}),lib.a=lib.inl.extend({lnkid:null,rend:function(){var e=this.rendK(),t=this.e.getAttribute("href"),r=this.e.title?' "'+this.e.title+'"':"";return!this.e.hasAttribute("href")||t==e||"#"==t[0]&&!cfg.hash_lnks?e:cfg.link_list?"["+e+"] ["+(this.lnkid+1)+"]":"["+e+"]("+t+r+")"}}),lib.img=lib.inl.extend({lnkid:null,rend:function(){var e=this.e.alt,t=this.e.getAttribute("src");if(cfg.link_list)return"!["+e+"] ["+(this.lnkid+1)+"]";var r=this.e.title?' "'+this.e.title+'"':"";return"!["+e+"]("+t+r+")"}}),lib.em=lib.inl.extend({wrap:cfg.emph_char}),lib.del=cfg.gfm_del?lib.inl.extend({wrap:"~~"}):lib.tinl.extend(),lib.br=lib.inl.extend({wrap:["",function(){var e=cfg.br_only?"<br>":"  ";return this.p instanceof lib.h?"<br>":e+"\n"}]}),lib.strong=lib.inl.extend({wrap:rep(cfg.bold_char,2)}),lib.blockquote=lib.blk.extend({lnPfx:"> ",rend:function(){return this.supr().replace(/>[ \t]$/gm,">")}}),lib.pre=lib.blk.extend({tagr:!0,wrapK:"\n",lnInd:0}),lib.code=lib.blk.extend({tagr:!1,wrap:"",wrapK:function(e){return-1!==e.indexOf("`")?"``":"`"},lnInd:0,init:function(e,t,r){if(this.supr(e,t,r),this.p instanceof lib.pre)if(this.p.tagr=!1,cfg.gfm_code){var n=this.e.getAttribute("class");n=(n||"").split(" ")[0],0===n.indexOf("lang-")&&(n=n.substr(5)),this.wrapK=[cfg.gfm_code+n+"\n","\n"+cfg.gfm_code]}else this.wrapK="",this.p.lnInd=4},rendK:function(){if(this.p instanceof lib.pre){var e=this.e[textContProp];return cfg.trim_code?e.trim():e}return this.supr()}}),lib.table=cfg.gfm_tbls?lib.blk.extend({cols:[],init:function(e,t,r){this.supr(e,t,r),this.cols=[]},rend:function(){for(var e=0;this.c.length>e;e++)for(var t=0;this.c[e].c.length>t;t++)for(var r=0;this.c[e].c[t].c.length>r;r++)this.c[e].c[t].c[r].prep();return this.supr()}}):lib.tblk.extend(),lib.thead=cfg.gfm_tbls?lib.cblk.extend({wrap:["\n",function(){for(var e="",t=0;this.p.cols.length>t;t++){var r=this.p.cols[t],n="c"==r.a[0]?":":" ",i="r"==r.a[0]||"c"==r.a[0]?":":" ";e+=(0==t&&cfg.tbl_edges?"|":"")+n+rep("-",r.w)+i+(this.p.cols.length-1>t||cfg.tbl_edges?"|":"")}return"\n"+trim12(e)}]}):lib.ctblk.extend(),lib.tbody=cfg.gfm_tbls?lib.cblk.extend():lib.ctblk.extend(),lib.tfoot=cfg.gfm_tbls?lib.cblk.extend():lib.ctblk.extend(),lib.tr=cfg.gfm_tbls?lib.cblk.extend({wrapK:[cfg.tbl_edges?"| ":"",cfg.tbl_edges?" |":""]}):lib.ctblk.extend(),lib.th=cfg.gfm_tbls?lib.inl.extend({guts:null,wrap:[function(){var e,t=this.p.p.p.cols[this.i],r=0==this.i?"":" ",n=t.w-this.guts.length;switch(t.a[0]){case"r":e=rep(" ",n);break;case"c":e=rep(" ",Math.floor(n/2));break;default:e=""}return r+e},function(){var e,t=this.p.p.p.cols[this.i],r=this.i==this.p.c.length-1?"":" |",n=t.w-this.guts.length;switch(t.a[0]){case"r":e="";break;case"c":e=rep(" ",Math.ceil(n/2));break;default:e=rep(" ",n)}return e+r}],prep:function(){this.guts=this.rendK(),this.rendK=function(){return this.guts};var e=this.p.p.p.cols;e[this.i]||(e[this.i]={w:null,a:""});var t=e[this.i];t.w=Math.max(t.w||0,this.guts.length);var r=this.e.align||this.e.style.textAlign;r&&(t.a=r)}}):lib.ctblk.extend(),lib.td=lib.th.extend(),lib.txt=lib.inl.extend({initK:function(){this.c=this.e[textContProp].split(/^/gm)},rendK:function(){var e=this.c.join("").replace(/\r/gm,"");return this.p instanceof lib.code||this.p instanceof lib.pre||(e=e.replace(/^\s*([#*])/gm,function(e,t){return e.replace(t,"\\"+t)})),0==this.i&&(e=e.replace(/^\n+/,"")),this.i==this.p.c.length-1&&(e=e.replace(/\n+$/,"")),e.replace(/\u00a0/gm,cfg.nbsp_spc?" ":"&nbsp;")}}),lib.rawhtml=lib.blk.extend({initK:function(){this.guts=outerHTML(this.e)},rendK:function(){return this.guts}});for(var i in cfg.unsup_tags)cfg.unsup_tags[i]=RegExp("^(?:"+("inline"==i?"a|em|strong|img|code|del|":"")+cfg.unsup_tags[i].replace(/\s/g,"|")+")$")},!function(e,t,r){"function"==typeof define?define(r):"undefined"!=typeof module?module.exports=r():t[e]=r()}("klass",this,function(){function e(e){return i.call(t(e)?e:function(){},e,1)}function t(e){return typeof e===o}function r(e,t,r){return function(){var n=this.supr;this.supr=r[s][e];var i={}.fabricatedUndefined,o=i;try{o=t.apply(this,arguments)}finally{this.supr=n}return o}}function n(e,n,i){for(var o in n)n.hasOwnProperty(o)&&(e[o]=t(n[o])&&t(i[s][o])&&a.test(n[o])?r(o,n[o],i):n[o])}function i(e,r){function i(){}function o(){this.init?this.init.apply(this,arguments):(r||c&&a.apply(this,arguments),u.apply(this,arguments))}i[s]=this[s];var a=this,l=new i,c=t(e),u=c?e:this,f=c?{}:e;return o.methods=function(e){return n(l,e,a),o[s]=l,this},o.methods.call(o,f).prototype.constructor=o,o.extend=arguments.callee,o[s].implement=o.statics=function(e,t){return e="string"==typeof e?function(){var r={};return r[e]=t,r}():e,n(this,e,a),this},o}var o="function",a=/xyz/.test(function(){})?/\bsupr\b/:/.*/,s="prototype";return e});