reMarked=function(e){function t(e,n){if(!n)return e;for(var i in e)"Object"==r(n[i])?t(e[i],n[i]):n[i]!==void 0&&(e[i]=n[i])}function r(e){return Object.prototype.toString.call(e).slice(8,-1)}function n(e,t){for(var r="";t-->0;)r+=e;return r}function i(e){for(var e=e.replace(/^\s\s*/,""),t=/\s/,r=e.length;t.test(e.charAt(--r)););return e.slice(0,r+1)}function o(e,t){if(!e)return"";for(var r,n="<"+e,i=0;t.attributes.length>i;i++)r=t.attributes.item(i),n+=" "+r.nodeName+'="'+r.nodeValue+'"';return n+">"}function a(e){return e?"</"+e+">":""}function s(e,t){return e.replace(/^/gm,t)}function l(e){return("#text"==e.nodeName?"txt":e.nodeName).toLowerCase()}function c(e,t){var r,n;return t instanceof Array?(r=t[0],n=t[1]):r=n=t,r=r instanceof Function?r.call(this,e):r,n=n instanceof Function?n.call(this,e):n,r+e+n}function u(e){return e.outerHTML||function(e){var t,r=document.createElement("div");return r.appendChild(e.cloneNode(!0)),t=r.innerHTML,r=null,t}(e)}var f=[],d={link_list:!1,h1_setext:!0,h2_setext:!0,h_atx_suf:!1,gfm_code:!1,li_bullet:"*-+"[0],hr_char:"-_*"[0],indnt_str:["    ","	","  "][0],bold_char:"*_"[0],emph_char:"*_"[1],gfm_del:!0,gfm_tbls:!0,tbl_edges:!1,hash_lnks:!1,br_only:!1,col_pre:"col ",unsup_tags:{ignore:"script style noscript",inline:"span sup sub i u b center big",block2:"div form fieldset dl header footer address article aside figure hgroup section",block1c:"dt dd caption legend figcaption output",block2c:"canvas audio video iframe"},tag_remap:{i:"em",b:"strong"}};t(d,e),this.render=function(e){if(f=[],"string"==typeof e){var t=e;e=document.createElement("div"),e.innerHTML=t}var r=new h.tag(e,null,0),i=r.rend().replace(/^[\t ]+\n/gm,"\n");if(d.link_list&&f.length>0){i+="\n\n";for(var o=0,a=0;f.length>a;a++)if(f[a].e.title){var s=f[a].e.href.length;s&&s>o&&(o=s)}for(var c=0;f.length>c;c++){var u=f[c].e.title?n(" ",o+2-f[c].e.href.length)+'"'+f[c].e.title+'"':"";i+="  ["+(+c+1)+"]: "+("a"==l(f[c].e)?f[c].e.href:f[c].e.src)+u+"\n"}}return i.replace(/^[\t ]+\n/gm,"\n")};var h={};h.tag=klass({wrap:"",lnPfx:"",lnInd:0,init:function(e,t,r){this.e=e,this.p=t,this.i=r,this.c=[],this.tag=l(e),this.initK()},initK:function(){var e;if(this.e.hasChildNodes()){var t,r,n=d.unsup_tags.inline;if("table"==l(this.e)&&this.e.hasChildNodes()&&!this.e.tHead){var i=document.createElement("thead"),o=this.e.tBodies[0],a=o.rows[0],s=a.cells[0];if("th"==l(s))i.appendChild(a);else for(var c,e=0,u=a.cells.length,p=i.insertRow();u>e++;)c=document.createElement("th"),c.textContent=d.col_pre+e,p.appendChild(c);this.e.insertBefore(i,o)}for(e in this.e.childNodes)if(/\d+/.test(e)&&(t=this.e.childNodes[e],r=l(t),r in d.tag_remap&&(r=d.tag_remap[r]),!d.unsup_tags.ignore.test(r))){if("txt"==r&&/^\s+$/.test(t.textContent)){if(0==e||e==this.e.childNodes.length-1)continue;var m=this.e.childNodes[e-1],g=this.e.childNodes[e+1];if(m&&!l(m).match(n)||g&&!l(g).match(n))continue}var v=null;if(!h[r]){var y=d.unsup_tags;y.inline.test(r)?r="tinl":y.block2.test(r)?r="tblk":y.block1c.test(r)?r="ctblk":y.block2c.test(r)?(r="ctblk",v=["\n\n",""]):r="rawhtml"}var b=new h[r](t,this,this.c.length);v&&(b.wrap=v),(b instanceof h.a&&t.href||b instanceof h.img)&&(b.lnkid=f.length,f.push(b)),this.c.push(b)}}},rend:function(){return this.rendK().replace(/\n{3,}/gm,"\n\n")},rendK:function(){for(var e,t="",r=0;this.c.length>r;r++)e=this.c[r],t+=(e.bef||"")+e.rend()+(e.aft||"");return t.replace(/^\n+|\n+$/,"")}}),h.blk=h.tag.extend({wrap:["\n\n",""],wrapK:null,tagr:!1,lnInd:null,init:function(e,t,r){this.supr(e,t,r),null===this.lnInd&&(this.lnInd=this.p&&this.tagr&&this.c[0]instanceof h.blk?4:0),null===this.wrapK&&(this.wrapK=this.tagr&&this.c[0]instanceof h.blk?"\n":"")},rend:function(){return c.call(this,(this.tagr?o(this.tag,this.e):"")+c.call(this,s(s(this.rendK(),this.lnPfx),n(" ",this.lnInd)),this.wrapK)+(this.tagr?a(this.tag):""),this.wrap)},rendK:function(){var e=this.supr();if(this.p instanceof h.li){var t=null,r=e.match(/^[\t ]+/gm);if(!r)return e;for(var n=0;r.length>n;n++)(null===t||r[n][0].length<t.length)&&(t=r[n][0]);return e.replace(RegExp("^"+t),"")}return e}}),h.tblk=h.blk.extend({tagr:!0}),h.cblk=h.blk.extend({wrap:["\n",""]}),h.ctblk=h.cblk.extend({tagr:!0}),h.inl=h.tag.extend({rend:function(){return c.call(this,this.rendK(),this.wrap)}}),h.tinl=h.inl.extend({tagr:!0,rend:function(){return o(this.tag,this.e)+c.call(this,this.rendK(),this.wrap)+a(this.tag)}}),h.p=h.blk.extend({rendK:function(){return this.supr().replace(/^\s+/gm,"")}}),h.list=h.blk.extend({expn:!1,wrap:[function(){return this.p instanceof h.li?"\n":"\n\n"},""]}),h.ul=h.list.extend({}),h.ol=h.list.extend({}),h.li=h.cblk.extend({wrap:["\n",function(e){return this.p.expn||e.match(/\n{2}/gm)?"\n":""}],wrapK:[function(){return"ul"==this.p.tag?d.li_bullet+" ":this.i+1+".  "},""],rendK:function(){return this.supr().replace(/\n([^\n])/gm,"\n"+d.indnt_str+"$1")}}),h.hr=h.blk.extend({wrap:["\n\n",n(d.hr_char,3)]}),h.h=h.blk.extend({}),h.h_setext=h.h.extend({}),d.h1_setext&&(h.h1=h.h_setext.extend({wrapK:["",function(e){return"\n"+n("=",e.length)}]})),d.h2_setext&&(h.h2=h.h_setext.extend({wrapK:["",function(e){return"\n"+n("-",e.length)}]})),h.h_atx=h.h.extend({wrapK:[function(){return n("#",this.tag[1])+" "},function(){return d.h_atx_suf?" "+n("#",this.tag[1]):""}]}),!d.h1_setext&&(h.h1=h.h_atx.extend({})),!d.h2_setext&&(h.h2=h.h_atx.extend({})),h.h3=h.h_atx.extend({}),h.h4=h.h_atx.extend({}),h.h5=h.h_atx.extend({}),h.h6=h.h_atx.extend({}),h.a=h.inl.extend({lnkid:null,rend:function(){var e=this.rendK(),t=this.e.getAttribute("href"),r=this.e.title?' "'+this.e.title+'"':"";return!t||t==e||"#"==t[0]&&!d.hash_lnks?e:d.link_list?"["+e+"] ["+(this.lnkid+1)+"]":"["+e+"]("+t+r+")"}}),h.img=h.inl.extend({lnkid:null,rend:function(){var e=this.e.alt,t=this.e.getAttribute("src");if(d.link_list)return"!["+e+"] ["+(this.lnkid+1)+"]";var r=this.e.title?' "'+this.e.title+'"':"";return"!["+e+"]("+t+r+")"}}),h.em=h.inl.extend({wrap:d.emph_char}),h.del=d.gfm_del?h.inl.extend({wrap:"~~"}):h.tinl.extend(),h.br=h.inl.extend({wrap:["",function(){var e=d.br_only?"<br>":"  ";return this.p instanceof h.h?"<br>":e+"\n"}]}),h.strong=h.inl.extend({wrap:n(d.bold_char,2)}),h.blockquote=h.blk.extend({lnPfx:"> ",rend:function(){return this.supr().replace(/>[ \t]$/gm,">")}}),h.pre=h.blk.extend({tagr:!0,wrapK:"\n",lnInd:0}),h.code=h.blk.extend({tagr:!1,wrap:"",wrapK:function(e){return-1!==e.indexOf("`")?"``":"`"},lnInd:0,init:function(e,t,r){if(this.supr(e,t,r),this.p instanceof h.pre)if(this.p.tagr=!1,d.gfm_code){var n=this.e.getAttribute("class");n=(n||"").split(" ")[0],0===n.indexOf("lang-")&&(n=n.substr(5)),this.wrapK=["```"+n+"\n","\n```"]}else this.wrapK="",this.p.lnInd=4}}),h.table=d.gfm_tbls?h.blk.extend({cols:[],init:function(e,t,r){this.supr(e,t,r),this.cols=[]},rend:function(){for(var e=0;this.c.length>e;e++)for(var t=0;this.c[e].c.length>t;t++)for(var r=0;this.c[e].c[t].c.length>r;r++)this.c[e].c[t].c[r].prep();return this.supr()}}):h.tblk.extend(),h.thead=d.gfm_tbls?h.cblk.extend({wrap:["\n",function(){for(var e="",t=0;this.p.cols.length>t;t++){var r=this.p.cols[t],o="c"==r.a[0]?":":" ",a="r"==r.a[0]||"c"==r.a[0]?":":" ";e+=(0==t&&d.tbl_edges?"|":"")+o+n("-",r.w)+a+(this.p.cols.length-1>t||d.tbl_edges?"|":"")}return"\n"+i(e)}]}):h.ctblk.extend(),h.tbody=d.gfm_tbls?h.cblk.extend():h.ctblk.extend(),h.tfoot=d.gfm_tbls?h.cblk.extend():h.ctblk.extend(),h.tr=d.gfm_tbls?h.cblk.extend({wrapK:[d.tbl_edges?"| ":"",d.tbl_edges?" |":""]}):h.ctblk.extend(),h.th=d.gfm_tbls?h.inl.extend({guts:null,wrap:[function(){var e,t=this.p.p.p.cols[this.i],r=0==this.i?"":" ",i=t.w-this.guts.length;switch(t.a[0]){case"r":e=n(" ",i);break;case"c":e=n(" ",Math.floor(i/2));break;default:e=""}return r+e},function(){var e,t=this.p.p.p.cols[this.i],r=this.i==this.p.c.length-1?"":" |",i=t.w-this.guts.length;switch(t.a[0]){case"r":e="";break;case"c":e=n(" ",Math.ceil(i/2));break;default:e=n(" ",i)}return e+r}],prep:function(){this.guts=this.rendK(),this.rendK=function(){return this.guts};var e=this.p.p.p.cols;e[this.i]||(e[this.i]={w:null,a:""});var t=e[this.i];t.w=Math.max(t.w||0,this.guts.length),this.e.align&&(t.a=this.e.align)}}):h.ctblk.extend(),h.td=h.th.extend(),h.txt=h.inl.extend({initK:function(){this.c=this.e.textContent.split(/^/gm)},rendK:function(){var e=this.c.join("").replace(/\r/gm,"");return this.p instanceof h.code||this.p instanceof h.pre||(e=e.replace(/^\s*#/gm,"\\#").replace(/\*/gm,"\\*")),0==this.i&&(e=e.replace(/^\n+/,"")),this.i==this.p.c.length-1&&(e=e.replace(/\n+$/,"")),e}}),h.rawhtml=h.blk.extend({initK:function(){this.guts=u(this.e)},rendK:function(){return this.guts}});for(var p in d.unsup_tags)d.unsup_tags[p]=RegExp("^(?:"+("inline"==p?"a|em|strong|img|code|del|":"")+d.unsup_tags[p].replace(/\s/g,"|")+")$")},!function(e,t){"function"==typeof define?define(t):"undefined"!=typeof module?module.exports=t():this[e]=t()}("klass",function(){function e(e){return i.call(t(e)?e:function(){},e,1)}function t(e){return typeof e===s}function r(e,t,r){return function(){var n=this.supr;this.supr=r[c][e];var i=t.apply(this,arguments);return this.supr=n,i}}function n(e,n,i){for(var o in n)n.hasOwnProperty(o)&&(e[o]=t(n[o])&&t(i[c][o])&&l.test(n[o])?r(o,n[o],i):n[o])}function i(e,r){function i(){}function o(){this.init?this.init.apply(this,arguments):(r||l&&a.apply(this,arguments),u.apply(this,arguments))}i[c]=this[c];var a=this,s=new i,l=t(e),u=l?e:this,f=l?{}:e;return o.methods=function(e){return n(s,e,a),o[c]=s,this},o.methods.call(o,f).prototype.constructor=o,o.extend=arguments.callee,o[c].implement=o.statics=function(e,t){return e="string"==typeof e?function(){var r={};return r[e]=t,r}():e,n(this,e,a),this},o}var o=this,a=o.klass,s="function",l=/xyz/.test(function(){})?/\bsupr\b/:/.*/,c="prototype";return e.noConflict=function(){return o.klass=a,this},o.klass=e,e});