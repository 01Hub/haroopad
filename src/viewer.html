<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <link rel="stylesheet" href="css/Tocify/jquery.tocify.css">
  <link rel="stylesheet" href="css/viewer.css">
  <!-- <link rel="stylesheet" href="css/bootstrap.css"> -->
  <script src="js/vendors/jquery-1.9.1.min.js"></script>
  <script src="js/vendors/jquery-ui-1.9.2.custom.min.js"></script>
  <script src="js/vendors/jquery.tocify.js"></script>
  <script src="js/vendors/js-url.js"></script>
  <script>
    // Load native UI library.
    var gui = require('nw.gui');

    function loadCss(url) {
      var link = document.createElement("link");
          link.type = "text/css";
          link.rel = "stylesheet";
          link.href = url;
      document.getElementsByTagName("head")[0].appendChild(link);
    }

    function setViewStyle(style) {
      loadCss('css/viewer/'+ style +'.css');
    }
    function setCodeStyle(style) {
      loadCss('css/code/'+ style +'.css');
    }
    
    function createTOC() {
      $("#toc").html('');
      $("#toc").tocify({ selectors: "h2, h3, h4" }).data("toc-tocify").generateToc();
      // $("#toc").tocify();
    }

    /**
     * update contents
     * @param  {[type]} contents [description]
     * @return {[type]}          [description]
     */
    function update(contents) {
      //unregister previous anchor click event handler
      $('a').off('click', '**');
      $('#contents').html(contents);

      createTOC();
    }

    function allowLink() {
      $('a').on('click', function(e) {
        gui.Shell.openExternal($(e.target).attr('href'));
        e.preventDefault();
      });
    }

    function blockLink() {
      $('a').on('click', function(e) {
        e.preventDefault();
      });
    }

    /**
     * sync scroll position
     * @param  {[type]} per [description]
     * @return {[type]}     [description]
     */
    function scrollTop(per) {
      var h = $(window).height();
      var top = $(document.body).prop('clientHeight') - h;

      $(window).scrollTop(top / 100 * per);
    }
  </script>
</head>
<body>
  <div id="toc"></div>
  <div id="contents"></div>
</body>
</html>
